-- === Services ===
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local MarketplaceService = game:GetService("MarketplaceService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local requestFunction = (syn and syn.request) or (http and http.request) or (http_request) or (fluxus and fluxus.request)

-- === Executor Name sebelum UI ===
local executorName = identifyexecutor and identifyexecutor() or "Unknown Executor"

-- === Load Rayfield UI ===
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
    Name = "Learzy Hub | " .. executorName,
    Theme = "Amethyst",
    ToggleUIKeybind = "K",
})

-- === Tabs ===
local tabPlayer = Window:CreateTab("Player", 4483362458)
local tabVisual = Window:CreateTab("Visual", 4483362458)
local tabCombat = Window:CreateTab("Combat", 4483362458)
local tabVehicle = Window:CreateTab("Vehicle", 4483362458)

tabPlayer:CreateParagraph({Title = "Player", Content = "Fitur player akan ditambahkan..."})
tabVisual:CreateParagraph({Title = "Visual", Content = "ESP Visual tersedia di sini."})
tabCombat:CreateParagraph({Title = "Combat", Content = "Fitur combat akan ditambahkan..."})
tabVehicle:CreateParagraph({Title = "Vehicle", Content = "Fitur kendaraan akan ditambahkan..."})

-- === Fly System ===
local speed = 50
local flying = false
local moveDir = Vector3.zero
local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

local bv = Instance.new("BodyVelocity")
bv.Name = "FlyBV"
bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)
bv.P = 1e4
bv.Velocity = Vector3.zero

local bg = Instance.new("BodyGyro")
bg.Name = "FlyBG"
bg.MaxTorque = Vector3.new(1e5, 1e5, 1e5)
bg.P = 1e4
bg.CFrame = hrp.CFrame

local function setFly(state)
    flying = state
    if flying then
        bv.Parent = hrp
        bg.Parent = hrp
    else
        bv.Parent = nil
        bg.Parent = nil
        moveDir = Vector3.zero
    end
end

tabPlayer:CreateToggle({
    Name = "Fly (Undetected + Mobile)",
    CurrentValue = false,
    Callback = setFly
})

RunService.RenderStepped:Connect(function()
    if flying then
        local camCF = workspace.CurrentCamera.CFrame
        local forward = camCF.LookVector
        local right = camCF.RightVector
        local up = Vector3.new(0, 1, 0)
        local dir = Vector3.zero
        dir += moveDir.X * right
        dir += moveDir.Y * up
        dir += moveDir.Z * forward
        if dir.Magnitude > 0 then dir = dir.Unit end
        bv.Velocity = dir * speed
        bg.CFrame = CFrame.new(Vector3.zero, forward)
    end
end)

-- === Mobile Fly GUI ===
local screenGui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
screenGui.Name = "FlyTouchGUI"
screenGui.ResetOnSpawn = false

local function createButton(name, pos, size, text, callback)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, size.X, 0, size.Y)
    btn.Position = UDim2.new(0, pos.X, 0, pos.Y)
    btn.Text = text
    btn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.TextScaled = true
    btn.Parent = screenGui
    btn.AutoButtonColor = true
    btn.Name = name
    btn.MouseButton1Down:Connect(callback)
    btn.MouseButton1Up:Connect(function()
        if name ~= "Toggle" then moveDir = Vector3.zero end
    end)
end

createButton("Toggle", Vector2.new(20, 500), Vector2.new(100, 50), "Fly", function() setFly(not flying) end)
createButton("Up", Vector2.new(130, 430), Vector2.new(50, 50), "↑", function() moveDir = Vector3.new(0, 1, 0) end)
createButton("Down", Vector2.new(130, 500), Vector2.new(50, 50), "↓", function() moveDir = Vector3.new(0, -1, 0) end)
createButton("Forward", Vector2.new(190, 465), Vector2.new(50, 50), "→", function() moveDir = Vector3.new(0, 0, 1) end)
createButton("Back", Vector2.new(70, 465), Vector2.new(50, 50), "←", function() moveDir = Vector3.new(0, 0, -1) end)
